# 591-Notion æ™ºèƒ½è‡ªå‹•åŒ–ç³»çµ± (Augment ç‰ˆæœ¬)

## ğŸ¯ ç³»çµ±æ¦‚è¿°

é€™æ˜¯ä¸€å€‹åŸºæ–¼ **MCP (Model Context Protocol)** çš„æ™ºèƒ½ç§Ÿå±‹è‡ªå‹•åŒ–ç³»çµ±ï¼Œèƒ½å¤ ï¼š

- ğŸ¤– **AI æ™ºèƒ½è™•ç†**: è‡ªå‹•åˆ†æå’Œæ˜ å°„ 591 ç§Ÿå±‹è³‡æ–™åˆ° Notion 23 å€‹å°ˆæ¥­æ¬„ä½
- ğŸ“Š **æ™ºèƒ½è©•åˆ†ç³»çµ±**: æ ¹æ“šå€‹äººç§Ÿå±‹éœ€æ±‚è‡ªå‹•è©•åˆ†å’Œç¯©é¸æˆ¿æº
- ğŸ”— **MCP æ¨™æº–æ¥å£**: æä¾›æ¨™æº–åŒ–çš„ API æ¥å£ï¼Œæ”¯æ´å„ç¨® AI å·¥å…·æ•´åˆ
- ğŸ  **å®Œæ•´è³‡æ–™ç®¡ç†**: æ”¯æ´ Notion è³‡æ–™åº«çš„å®Œæ•´ CRUD æ“ä½œ
- ğŸ± **å¯µç‰©å‹å–„**: ç‰¹åˆ¥é‡å°å¯µç‰©å‹å–„æˆ¿æºé€²è¡Œå„ªåŒ–ç¯©é¸

## ğŸ—ï¸ ç³»çµ±æ¶æ§‹

```
591-notion-automation-Augment/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ mcp/                    # MCP æœå‹™æ¥å£
â”‚   â”‚   â””â”€â”€ mcpServer.js       # MCP æ¨™æº–æœå‹™å™¨
â”‚   â”œâ”€â”€ services/              # æ ¸å¿ƒæœå‹™
â”‚   â”‚   â””â”€â”€ notionService.js   # Notion API æœå‹™
â”‚   â”œâ”€â”€ mappers/               # è³‡æ–™æ˜ å°„
â”‚   â”‚   â””â”€â”€ intelligentMapper.js # AI æ™ºèƒ½æ˜ å°„ç³»çµ±
â”‚   â”œâ”€â”€ processors/            # è³‡æ–™è™•ç†
â”‚   â”‚   â””â”€â”€ intelligentScorer.js # æ™ºèƒ½è©•åˆ†ç³»çµ±
â”‚   â””â”€â”€ index.js              # ä¸»ç¨‹å¼
â”œâ”€â”€ examples/                  # ä½¿ç”¨ç¯„ä¾‹
â”‚   â””â”€â”€ mcpClient.js          # MCP å®¢æˆ¶ç«¯ç¯„ä¾‹
â”œâ”€â”€ logs/                     # æ—¥èªŒæª”æ¡ˆ
â”œâ”€â”€ .env                      # ç’°å¢ƒè¨­å®š
â””â”€â”€ package.json             # å°ˆæ¡ˆè¨­å®š
```

## ğŸš€ å¿«é€Ÿé–‹å§‹

### 1. ç’°å¢ƒæº–å‚™

```bash
# ç¢ºèª Node.js ç‰ˆæœ¬ (éœ€è¦ >= 16.0.0)
node --version

# å®‰è£ç›¸ä¾å¥—ä»¶
npm install
```

### 2. ç’°å¢ƒè¨­å®š

ç·¨è¼¯ `.env` æª”æ¡ˆï¼š

```env
# Notion API è¨­å®š
NOTION_API_KEY=your_notion_api_key
NOTION_DATABASE_ID=your_database_id

# MCP æœå‹™è¨­å®š
MCP_PORT=3000
MCP_HOST=localhost

# è©•åˆ†ç³»çµ±è¨­å®š
MIN_SCORE_THRESHOLD=60
MAX_BUDGET_SUITE=15000
MAX_BUDGET_ROOM=10000
MAX_MRT_DISTANCE=15
```

### 3. å•Ÿå‹•ç³»çµ±

```bash
# å•Ÿå‹•å®Œæ•´ç³»çµ± (åŒ…å« MCP æœå‹™å™¨)
npm start

# é–‹ç™¼æ¨¡å¼ (è‡ªå‹•é‡å•Ÿ)
npm run dev

# åƒ…å•Ÿå‹• MCP æœå‹™å™¨
npm run mcp
```

## ğŸ“¡ MCP API ä½¿ç”¨æ–¹å¼

### åŸºæœ¬ç«¯é»

- **å¥åº·æª¢æŸ¥**: `GET /health`
- **æœå‹™ç‹€æ…‹**: `GET /mcp/status`
- **è™•ç†å–®ä¸€æˆ¿æº**: `POST /mcp/process-rental`
- **æ‰¹é‡è™•ç†**: `POST /mcp/batch-process`
- **åƒ…è©•åˆ†**: `POST /mcp/score-rental`

### API ç¯„ä¾‹

#### 1. è™•ç†å–®ä¸€æˆ¿æº

```javascript
const response = await fetch('http://localhost:3000/mcp/process-rental', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({
    rentalData: {
      title: 'å¤§å®‰å€ç²¾ç·»å¥—æˆ¿ è¿‘æ·é‹ç«™',
      price: 18000,
      address: 'å°åŒ—å¸‚å¤§å®‰å€æ•¦åŒ–å—è·¯äºŒæ®µ',
      description: 'è®Šé »å†·æ°£ï¼Œå†°ç®±ï¼Œæ´—è¡£æ©Ÿï¼Œå°å¤–çª—ï¼Œå¯é¤Šå¯µç‰©',
      facilities: ['è®Šé »å†·æ°£', 'å†°ç®±', 'æ´—è¡£æ©Ÿ', 'å°å¤–çª—'],
      contact: 'ç‹å…ˆç”Ÿ 0912-345-678',
      url: 'https://rent.591.com.tw/example-12345'
    },
    options: {
      minScore: 60,
      dryRun: false
    }
  })
});

const result = await response.json();
console.log(result);
```

#### 2. æ‰¹é‡è™•ç†æˆ¿æº

```javascript
const response = await fetch('http://localhost:3000/mcp/batch-process', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({
    rentals: [
      { title: 'æˆ¿æº1', price: 15000, /* ... */ },
      { title: 'æˆ¿æº2', price: 12000, /* ... */ }
    ],
    options: {
      minScore: 60,
      dryRun: true
    }
  })
});
```

## ğŸ§  æ™ºèƒ½è©•åˆ†ç³»çµ±

### è©•åˆ†æ¨™æº– (ç¸½åˆ† 110 åˆ†)

| é …ç›® | åˆ†æ•¸ | èªªæ˜ |
|------|------|------|
| åƒ¹æ ¼è©•åˆ† | 25åˆ† | åŸºæ–¼é ç®—ç¯„åœè©•åˆ† |
| å¿…è¦è¨­å‚™ | 40åˆ† | è®Šé »å†·æ°£ã€å†°ç®±ã€å°å¤–çª—ã€æ´—è¡£æ©Ÿ |
| åœ°ç†ä½ç½® | 20åˆ† | åŸå¸‚ã€å€åŸŸã€æ·é‹è·é›¢ |
| åŠ åˆ†é …ç›® | 15åˆ† | éœ²å°ã€ä¹¾æ·¨æ•´æ½”ã€å‹å–„ç’°å¢ƒ |
| å¯µç‰©å‹å–„ | 10åˆ† | é¡å¤–åŠ åˆ†é …ç›® |

### æ’é™¤æ¢ä»¶ (ç›´æ¥ 0 åˆ†)

- ç„¡å°å¤–çª—
- è€èˆŠå£ç™Œ
- ç³Ÿç³•æµ´å®¤
- å£ç´™å•é¡Œ
- éš”éŸ³å·®

### é©åˆåº¦è©•èª

- **90+ åˆ†**: éå¸¸é©åˆ
- **80-89 åˆ†**: å¾ˆé©åˆ
- **70-79 åˆ†**: é©åˆ
- **60-69 åˆ†**: å°šå¯è€ƒæ…®
- **40-59 åˆ†**: éœ€è¦è©•ä¼°
- **< 40 åˆ†**: ä¸é©åˆ

## ğŸ“Š Notion è³‡æ–™åº«æ¬„ä½æ˜ å°„

ç³»çµ±æ”¯æ´å®Œæ•´çš„ 23 å€‹æ¬„ä½è‡ªå‹•æ˜ å°„ï¼š

### æ ¸å¿ƒè³‡è¨Š
- æˆ¿æºåç¨± (title)
- ç§Ÿé‡‘ (number)
- æˆ¿å‹ (select)
- åœ°å€ (rich_text)
- å€åŸŸåç¨± (rich_text)
- å¸‚å€åç¨± (rich_text)

### è©•ä¼°è³‡è¨Š
- é©åˆåº¦ (rich_text)
- å¹³å‡è©•åˆ† (number)
- é‡è¦å„ªå‹¢ (rich_text)
- çœ‹æˆ¿ç‹€æ…‹ (select)

### è©³ç´°è³‡è¨Š
- è¨­å‚™èˆ‡ç‰¹è‰² (multi_select)
- äº¤é€šä¾¿åˆ©æ€§ (rich_text)
- ç”Ÿæ´»æ©Ÿèƒ½ (rich_text)
- å…¬å…±è¨­æ–½åŠç©ºé–“ (multi_select)

### è²¡å‹™è³‡è¨Š
- æ°´é›»è²» (rich_text)
- æŠ¼é‡‘ï¼ˆå€‹æœˆï¼‰(number)

### è¯ç¹«è³‡è¨Š
- æˆ¿æ±è¯ç¹«æ–¹å¼ (rich_text)
- ç¶²é é€£çµ (url)
- ç¶²å€ (url)

### ç®¡ç†æ¬„ä½
- å‚™è¨» (rich_text)
- ç°½ç´„æ³¨æ„äº‹é … (rich_text)
- ç…§ç‰‡ (files)
- æ›´æ–°æ—¥æœŸ (date)

## ğŸ› ï¸ é–‹ç™¼å·¥å…·

### å¯ç”¨æŒ‡ä»¤

```bash
# å•Ÿå‹•ç³»çµ±
npm start

# é–‹ç™¼æ¨¡å¼
npm run dev

# åŸ·è¡Œç¯„ä¾‹
npm run example

# ç”Ÿæˆå ±å‘Š
npm run report

# æŸ¥çœ‹æ—¥èªŒ
npm run logs

# åŸ·è¡Œæ¸¬è©¦
npm test
```

### æ—¥èªŒç³»çµ±

ç³»çµ±æä¾›å®Œæ•´çš„æ—¥èªŒè¨˜éŒ„ï¼š

- **æ§åˆ¶å°æ—¥èªŒ**: å½©è‰²æ ¼å¼ï¼Œé©åˆé–‹ç™¼
- **æª”æ¡ˆæ—¥èªŒ**: JSON æ ¼å¼ï¼Œé©åˆåˆ†æ
- **æ—¥èªŒæª”æ¡ˆ**: `logs/app.log`, `logs/mcp-server.log`, `logs/notion.log`

## ğŸ”§ é€²éšè¨­å®š

### è‡ªè¨‚è©•åˆ†æ¢ä»¶

ç·¨è¼¯ `src/processors/intelligentScorer.js` ä¸­çš„ `requirements` ç‰©ä»¶ï¼š

```javascript
this.requirements = {
  budget: {
    é›…æˆ¿: 10000,
    å¥—æˆ¿: 15000,
    // è‡ªè¨‚é ç®—
  },
  mustHave: [
    { name: 'è®Šé »å†·æ°£', keywords: ['è®Šé »å†·æ°£', 'å†·æ°£'], weight: 10 },
    // è‡ªè¨‚å¿…è¦è¨­å‚™
  ],
  // å…¶ä»–è¨­å®š...
};
```

### è‡ªè¨‚ Notion æ¬„ä½æ˜ å°„

ç·¨è¼¯ `src/mappers/intelligentMapper.js` ä¸­çš„ `notionSchema` ç‰©ä»¶ã€‚

## ğŸ“ˆ ç³»çµ±ç›£æ§

### å¥åº·æª¢æŸ¥

```bash
curl http://localhost:3000/health
```

### æœå‹™ç‹€æ…‹

```bash
curl http://localhost:3000/mcp/status
```

### çµ±è¨ˆå ±å‘Š

```bash
npm run report
```

## ğŸ› æ•…éšœæ’é™¤

### å¸¸è¦‹å•é¡Œ

1. **Notion é€£æ¥å¤±æ•—**
   - æª¢æŸ¥ `NOTION_API_KEY` æ˜¯å¦æ­£ç¢º
   - ç¢ºèª Integration å·²åŠ å…¥è³‡æ–™åº«

2. **è©•åˆ†çµæœç•°å¸¸**
   - æª¢æŸ¥æˆ¿æºè³‡æ–™æ ¼å¼
   - ç¢ºèªè©•åˆ†æ¢ä»¶è¨­å®š

3. **MCP æœå‹™ç„¡æ³•å•Ÿå‹•**
   - æª¢æŸ¥ç«¯å£æ˜¯å¦è¢«å ç”¨
   - ç¢ºèªç’°å¢ƒè®Šæ•¸è¨­å®š

### æ—¥èªŒåˆ†æ

```bash
# æŸ¥çœ‹å³æ™‚æ—¥èªŒ
tail -f logs/app.log

# æœå°‹éŒ¯èª¤
grep "ERROR" logs/app.log

# æŸ¥çœ‹ç‰¹å®šæ™‚é–“ç¯„åœ
grep "2024-01-01" logs/app.log
```

## ğŸ¤ è²¢ç»æŒ‡å—

1. Fork å°ˆæ¡ˆ
2. å»ºç«‹åŠŸèƒ½åˆ†æ”¯
3. æäº¤è®Šæ›´
4. å»ºç«‹ Pull Request

## ğŸ“„ æˆæ¬Š

MIT License

## ğŸ†˜ æ”¯æ´

å¦‚æœ‰å•é¡Œè«‹å»ºç«‹ Issue æˆ–è¯ç¹«é–‹ç™¼åœ˜éšŠã€‚

---

**ç”± Augment Agent é–‹ç™¼** ğŸ¤–
